<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Syang's Blog]]></title>
  <subtitle><![CDATA[不断发现，不断学习，不断成长，不断成熟]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://www.syang.xyz/"/>
  <updated>2015-05-06T02:13:11.000Z</updated>
  <id>http://www.syang.xyz/</id>
  
  <author>
    <name><![CDATA[Syang]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[PHP为什么低一等]]></title>
    <link href="http://www.syang.xyz/2015/05/06/PHP%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%8E%E4%B8%80%E7%AD%89/"/>
    <id>http://www.syang.xyz/2015/05/06/PHP为什么低一等/</id>
    <published>2015-05-06T02:13:11.000Z</published>
    <updated>2015-05-06T02:13:11.000Z</updated>
    <content type="html"></content>
    <summary type="html">
    
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Nginx 配置]]></title>
    <link href="http://www.syang.xyz/2015/05/05/Nginx-%E9%85%8D%E7%BD%AE/"/>
    <id>http://www.syang.xyz/2015/05/05/Nginx-配置/</id>
    <published>2015-05-05T09:06:32.000Z</published>
    <updated>2015-05-06T06:15:29.000Z</updated>
    <content type="html"><![CDATA[<h2 id="Nginx安装配置">Nginx安装配置</h2><h3 id="download">download</h3><p> wget <a href="http://nginx.org/download/nginx-1.6.0.tar.gz" target="_blank" rel="external">http://nginx.org/download/nginx-1.6.0.tar.gz</a><br> tar zxf nginx-1.6.0.tar.gz</p>
<hr>
<h3 id="configure">configure</h3><ol>
<li>需要根据ip做国家或者城市的分流的话可使用geoip模块；<br> 在添加geoip模块之前需要，下载并安装相关的库文件<br> wget <a href="http://geolite.maxmind.com/download/geoip/database/GeoLiteCity.dat.gz" target="_blank" rel="external">http://geolite.maxmind.com/download/geoip/database/GeoLiteCity.dat.gz</a><br> wget <a href="http://geolite.maxmind.com/download/geoip/database/GeoLiteCountry/GeoIP.dat.gz" target="_blank" rel="external">http://geolite.maxmind.com/download/geoip/database/GeoLiteCountry/GeoIP.dat.gz</a></li>
<li>对代码有压缩要求的需启用gzip模块；</li>
<li>使用https协议的话，则需要添加http_ssl_module模块；</li>
</ol>
<ul>
<li>编译安装<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> nginx-1.6.0</span><br><span class="line">./configure --with-http_ssl_module --with-http_geoip_module --with-http_gzip_static_module --prefix=/<span class="keyword">app</span>-data/nginx --http-<span class="keyword">log</span>-path=/<span class="keyword">app</span>-util/<span class="keyword">log</span>/nginx/base/access.<span class="keyword">log</span> --<span class="keyword">error</span>-<span class="keyword">log</span>-path=/<span class="keyword">app</span>-util/<span class="keyword">log</span>/nginx/base/<span class="keyword">error</span>.<span class="literal">log</span></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="config">config</h3><p>nginx.conf:通用全局的配置，如gzip压缩，geoip模块配置，work_process一般是核*2<br>site-available:已搭建服务<br>site-enabled:正使用的服务<br>内部配置文件需改动部分一般只有server_name和log地址。<br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">server</span> &#123;</span><br><span class="line">    <span class="title">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="title">set</span> <span class="variable">$root_folder</span> /app-data/www/域名/web;</span><br><span class="line">    <span class="title">root</span> <span class="variable">$root_folder</span>;</span><br><span class="line">    <span class="title">server_name</span> 域名;</span><br><span class="line">    <span class="title">location</span> / &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title">location</span> <span class="regexp">~ .(zip|js|css)</span> &#123;</span><br><span class="line">        <span class="title">expires</span> <span class="number">1d</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title">location</span> <span class="regexp">~ .(dzi|gif|jpeg|png|jpg|swf|ico)</span> &#123;</span><br><span class="line">        <span class="title">expires</span> <span class="number">1m</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title">location</span> <span class="regexp">~ /index.php</span> &#123;</span><br><span class="line">        <span class="title">fastcgi_pass</span>   <span class="number">127.0.0.1:9000</span>;</span><br><span class="line">        <span class="title">fastcgi_param</span>  SCRIPT_FILENAME  <span class="variable">$root_folder</span>/index.php;</span><br><span class="line">        <span class="title">include</span>        fastcgi_params;</span><br><span class="line">        <span class="title">fastcgi_param</span> PATH_INFO         <span class="variable">$fastcgi_path_info</span>;</span><br><span class="line">        <span class="title">fastcgi_param</span> HTTP_REFERER      <span class="variable">$http_referer</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title">location</span> <span class="regexp">~ /</span> &#123;</span><br><span class="line">        <span class="title">rewrite</span><span class="regexp"> ^/(.*)$</span> /index.php <span class="built_in">last</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title">error_log</span>  /app-util/log/nginx/A/error.log;</span><br><span class="line">    <span class="title">access_log</span> /app-util/log/nginx/A/access.log;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>启动<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/app-data/</span>nginx<span class="regexp">/sbin/</span>nginx</span><br><span class="line">如果只修改配置文件，则只须重新加载配置文件</span><br><span class="line"><span class="regexp">/app-data/</span>nginx<span class="regexp">/sbin/</span>nginx -s reload</span><br><span class="line">在使用ssl模块的情况下，可能有加载证书的过程，所以修改完配置文件可能需要关闭nginx，再启动才能有效</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Nginx负载均衡配置">Nginx负载均衡配置</h2><p>应用到的模块主要是upstream<br><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">upstream servers&#123;</span><br><span class="line">    server <span class="number">10.144</span>.<span class="number">22.204</span>:<span class="number">80</span> <span class="variable">weight=</span><span class="number">1</span> <span class="variable">max_fails=</span><span class="number">2</span> <span class="variable">fail_timeout=</span><span class="number">2</span>; </span><br><span class="line">    server www.baidu.com <span class="variable">weight=</span><span class="number">2</span> <span class="variable">max_fails=</span><span class="number">2</span> <span class="variable">fail_timeout=</span><span class="number">2</span>;</span><br><span class="line">    server <span class="number">10.163</span>.<span class="number">247.211</span>:<span class="number">80</span> <span class="variable">weight=</span><span class="number">1</span> <span class="variable">max_fails=</span><span class="number">2</span> <span class="variable">fail_timeout=</span><span class="number">2</span> down;</span><br><span class="line">&#125;</span><br><span class="line">weight:权重，上面两者的权重都为<span class="number">1</span></span><br><span class="line">max_fails:允许访问的最大失败次数，超过nginx就会将该站点标记为不可用。</span><br><span class="line">fail_timeout:访问超时</span><br><span class="line">down:表示该台主机暂时不可用</span><br></pre></td></tr></table></figure></p>
<p>根据url分流<br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">server</span> &#123;</span><br><span class="line">    <span class="title">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="title">server_name</span> test.qingvoice.com;</span><br><span class="line">    <span class="title">location</span> / &#123;</span><br><span class="line">        <span class="title">proxy_pass</span>  <span class="url">http://testservers</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title">location</span> <span class="regexp">~* "api"</span>&#123;</span><br><span class="line">        <span class="title">proxy_pass</span>  <span class="url">http://testpc</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>server:首先去查找匹配端口，再去匹配server_name<br>location:可匹配url去请求不同代理服务器，本机若要做站点，则端口需和主机不同。以上的配置对链接中含api的url可导流先前配置的upstream中</p>
<p>更加详细的Nginx配置文件介绍可查看<a href="http://nginx.org/en/docs/beginners_guide.html" target="_blank" rel="external">nginx</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="Nginx安装配置">Nginx安装配置</h2><h3 id="download">download</h3><p> wget <a href="http://nginx.org/download/nginx-1.6.0.tar.gz" target="_bla]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[BASH--string]]></title>
    <link href="http://www.syang.xyz/2015/05/05/BASH-string/"/>
    <id>http://www.syang.xyz/2015/05/05/BASH-string/</id>
    <published>2015-05-05T07:21:11.000Z</published>
    <updated>2015-05-05T08:15:27.000Z</updated>
    <content type="html"><![CDATA[<p>有时候我们需要对变量进行一些操作，比如截取，替换，删除等操作，很多同学会使用awk, sed 或cut等命令来干这事，其实，bash的内置的变量操作就可以干这个事。下面说明一些常用的方法：</p>
<p>这些操作需要使用 ${var} 这种变量的写法（用花括号）。</p>
<p>${\#var} 输出 var的字符串长度</p>
<p>${var:pos:len} 你可以理解为变量的切片操作。如：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="variable"><span class="keyword">var</span></span>=<span class="number">0123456789</span></span><br><span class="line">&gt; echo $&#123;<span class="variable"><span class="keyword">var</span></span>:<span class="number">2</span>&#125;</span><br><span class="line"><span class="number">23456789</span></span><br><span class="line">&gt; echo $&#123;<span class="variable"><span class="keyword">var</span></span>:<span class="number">2</span>:<span class="number">2</span>&#125;</span><br><span class="line"><span class="number">23</span></span><br><span class="line">&gt; echo $&#123;<span class="variable"><span class="keyword">var</span></span>:<span class="number">2</span>:<span class="number">3</span>&#125;</span><br><span class="line"><span class="number">234</span></span><br><span class="line">&gt; echo $&#123;<span class="variable"><span class="keyword">var</span></span>::<span class="number">1</span>&#125;</span><br><span class="line"><span class="number">0</span></span><br><span class="line">&gt; echo $&#123;<span class="variable"><span class="keyword">var</span></span>::-<span class="number">2</span>&#125;</span><br><span class="line"><span class="number">01234567</span></span><br></pre></td></tr></table></figure>
<p>${var#word} 或 ${var##word} 删除匹配word的前缀，#为最短匹配，##为最长匹配</p>
<p>${var%word} 或 ${var%%word} 删除匹配word的后缀，%为最短匹配，%%为最长匹配</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="keyword">var</span>=ababcdcd</span><br><span class="line">&gt; <span class="keyword">echo</span> $&#123;<span class="keyword">var</span><span class="comment">#a*b&#125;</span></span><br><span class="line">abcdcd</span><br><span class="line">&gt; <span class="keyword">echo</span> $&#123;<span class="keyword">var</span><span class="comment">##a*b&#125;</span></span><br><span class="line">cdcd</span><br><span class="line">&gt; <span class="keyword">echo</span> $&#123;<span class="keyword">var</span>%c*d&#125;</span><br><span class="line">ababcd</span><br><span class="line">&gt; <span class="keyword">echo</span> $&#123;<span class="keyword">var</span>%c*d&#125;</span><br><span class="line">ababcd</span><br><span class="line">&gt; <span class="keyword">echo</span> $&#123;<span class="keyword">var</span>%%c*d&#125;</span><br><span class="line">abab</span><br></pre></td></tr></table></figure>
<p>${var/pattern/replacement} 替换第一个匹配</p>
<p>${var//pattern/replacement} 替换所有的匹配</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span>=ababcdcd</span><br><span class="line">&gt; <span class="keyword">echo</span> $&#123;<span class="keyword">var</span>/ab/<span class="number">01</span>&#125;</span><br><span class="line"><span class="number">01</span>abcdcd</span><br><span class="line">&gt; <span class="keyword">echo</span> $&#123;<span class="keyword">var</span><span class="comment">//ab/01&#125;</span></span><br><span class="line"><span class="number">0101</span>cdcd</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p>有时候我们需要对变量进行一些操作，比如截取，替换，删除等操作，很多同学会使用awk, sed 或cut等命令来干这事，其实，bash的内置的变量操作就可以干这个事。下面说明一些常用的方法：</p>
<p>这些操作需要使用 ${var} 这种变量的写法（用花括号）。</p>
]]>
    </summary>
    
      <category term="bash" scheme="http://www.syang.xyz/tags/bash/"/>
    
      <category term="linux" scheme="http://www.syang.xyz/tags/linux/"/>
    
      <category term="string" scheme="http://www.syang.xyz/tags/string/"/>
    
      <category term="Linux" scheme="http://www.syang.xyz/categories/Linux/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Hello World]]></title>
    <link href="http://www.syang.xyz/2015/05/05/hello-world/"/>
    <id>http://www.syang.xyz/2015/05/05/hello-world/</id>
    <published>2015-05-05T07:14:41.000Z</published>
    <updated>2015-05-05T07:14:41.000Z</updated>
    <content type="html"><![CDATA[<p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="http://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick_Start">Quick Start</h2><h3 id="Create_a_new_post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run_server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate_static_files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy_to_remote_sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io]]>
    </summary>
    
  </entry>
  
</feed>